<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin Dashboard | STEAM LMS</title>
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicons/favicon-16x16.png">
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicons/favicon.ico">
    <link rel="manifest" href="assets/img/favicons/manifest.json">
    <meta name="msapplication-TileImage" content="assets/img/favicons/mstile-150x150.png">
    <meta name="theme-color" content="#ffffff">
    
    <!-- Stylesheets -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="assets/css/theme.css" rel="stylesheet" />
    <link href="assets/css/admin.css" rel="stylesheet" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <!-- Admin Dashboard Container -->
    <div class="admin-dashboard">
        <!-- Sidebar -->
        <nav class="admin-sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="assets/img/logos/penreach_logo.png" alt="STEAM LMS" width="140">
                </div>
                <h4>Admin Panel</h4>
            </div>
            
            <ul class="sidebar-menu">
                <li class="menu-item active">
                    <a href="#dashboard" class="menu-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#content" class="menu-link">
                        <i class="fas fa-book"></i>
                        <span>Content Management</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#grades" class="menu-link">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Grades</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#categories" class="menu-link">
                        <i class="fas fa-tags"></i>
                        <span>Categories</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#uploads" class="menu-link">
                        <i class="fas fa-upload"></i>
                        <span>File Uploads</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#metrics" class="menu-link">
                        <i class="fas fa-chart-bar"></i>
                        <span>Metrics & Analytics</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#settings" class="menu-link">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" onclick="showDatabaseModal()">
                        <i class="fas fa-database"></i>
                        <span>Database</span>
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-footer">
                <a href="index.html" class="btn btn-outline-light btn-sm">
                    <i class="fas fa-home me-2"></i>Back to Site
                </a>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="admin-main">
            <!-- Top Header -->
            <header class="admin-header">
                <div class="header-left">
                    <button class="sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">Dashboard</h1>
                </div>
                <div class="header-right">
                    <div class="admin-info">
                        <span class="admin-name">Administrator</span>
                        <div class="admin-avatar">
                            <i class="fas fa-user-shield"></i>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Dashboard Content -->
            <div class="admin-content">
                <!-- Dashboard Overview -->
                <section id="dashboard-section" class="content-section active">
                    <!-- Debug Button -->
                    <div class="mb-3">
                        <button onclick="debugDataLoad()" class="btn btn-warning btn-sm">
                            üêõ Debug Data Load
                        </button>
                        <button onclick="testAPI()" class="btn btn-info btn-sm ms-2">
                            üß™ Test API
                        </button>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-content">0</h3>
                                <p>Total Content Items</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-grades">0</h3>
                                <p>Grades Configured</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-tags"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-categories">0</h3>
                                <p>Categories</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-file"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-files">0</h3>
                                <p>Files Uploaded</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <h5>Recent Uploads</h5>
                            <div class="recent-uploads" id="recent-uploads">
                                <!-- Recent uploads will be populated here -->
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h5>System Status</h5>
                            <div class="system-status">
                                <div class="status-item">
                                    <i class="fas fa-database text-success"></i>
                                    <span>Database: Connected</span>
                                </div>
                                <div class="status-item">
                                    <i class="fas fa-server text-success"></i>
                                    <span>Storage: Available</span>
                                </div>
                                <div class="status-item">
                                    <i class="fas fa-shield-alt text-success"></i>
                                    <span>Security: Active</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Content Management Section -->
                <section id="content-section" class="content-section">
                    <div class="section-header">
                        <h2>Content Management</h2>
                        <div>
                            <button class="btn btn-success me-2" onclick="showEnhancedContentModal()">
                                <i class="fas fa-upload me-2"></i>Upload with Files
                            </button>
                            <button class="btn btn-warning me-2" onclick="openEnhancedModalDirect()">
                                <i class="fas fa-tools me-2"></i>Upload (Direct)
                            </button>
                            <button class="btn btn-primary" onclick="showContentModal()">
                                <i class="fas fa-plus me-2"></i>Add Simple Content
                            </button>
                        </div>
                    </div>
                    
                    <div class="content-filters">
                        <select class="form-select" id="grade-filter">
                            <option value="">All Grades</option>
                        </select>
                        <select class="form-select" id="category-filter">
                            <option value="">All Categories</option>
                        </select>
                        <input type="text" class="form-control" id="content-search" placeholder="Search content...">
                    </div>
                    
                    <div class="content-table-container">
                        <table class="content-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Grade</th>
                                    <th>Category</th>
                                    <th>Type</th>
                                    <th>Files</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="content-table-body">
                                <!-- Content rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- Grades Section -->
                <section id="grades-section" class="content-section">
                    <div class="section-header">
                        <h2>Grade Management</h2>
                        <button class="btn btn-primary" onclick="showGradeModal()">
                            <i class="fas fa-plus me-2"></i>Add Grade
                        </button>
                    </div>
                    
                    <div class="grades-table-container">
                        <table class="content-table">
                            <thead>
                                <tr>
                                    <th>Grade Name</th>
                                    <th>Age Range</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="grades-table-body">
                                <!-- Grade rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- Categories Section -->
                <section id="categories-section" class="content-section">
                    <div class="section-header">
                        <h2>Category Management</h2>
                        <button class="btn btn-primary" onclick="showCategoryModal()">
                            <i class="fas fa-plus me-2"></i>Add Category
                        </button>
                    </div>
                    
                    <div class="categories-table-container">
                        <table class="content-table">
                            <thead>
                                <tr>
                                    <th>Category Name</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="categories-table-body">
                                <!-- Category rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- File Uploads Section -->
                <section id="uploads-section" class="content-section">
                    <div class="section-header">
                        <h2>File Uploads</h2>
                        <button class="btn btn-primary" onclick="showUploadModal()">
                            <i class="fas fa-upload me-2"></i>Upload Files
                        </button>
                    </div>
                    
                    <div class="upload-area" id="upload-area">
                        <div class="upload-content">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <h4>Drag & Drop Files Here</h4>
                            <p>or click to browse</p>
                            <p class="text-muted">Supported formats: PDF, DOC, DOCX, PPT, PPTX, XLS, XLSX, JPG, PNG, MP4, MP3</p>
                        </div>
                        <input type="file" id="file-input" multiple accept=".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.jpg,.jpeg,.png,.mp4,.mp3">
                    </div>
                    
                    <div class="files-list" id="files-list">
                        <!-- Uploaded files will be listed here -->
                    </div>
                </section>
                
                <!-- Metrics Section -->
                <section id="metrics-section" class="content-section">
                    <div class="section-header">
                        <h2>Metrics & Analytics</h2>
                    </div>
                    
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <h5>Content Distribution</h5>
                            <canvas id="content-chart"></canvas>
                        </div>
                        <div class="metric-card">
                            <h5>Grade Usage</h5>
                            <canvas id="grade-chart"></canvas>
                        </div>
                        <div class="metric-card">
                            <h5>File Type Distribution</h5>
                            <canvas id="file-chart"></canvas>
                        </div>
                        <div class="metric-card">
                            <h5>Upload Activity</h5>
                            <canvas id="activity-chart"></canvas>
                        </div>
                    </div>
                </section>
                
                <!-- Settings Section -->
                <section id="settings-section" class="content-section">
                    <div class="section-header">
                        <h2>Settings</h2>
                    </div>
                    
                    <div class="settings-container">
                        <div class="setting-group">
                            <h4>System Configuration</h4>
                            <div class="setting-item">
                                <label>Max File Size (MB)</label>
                                <input type="number" class="form-control" id="max-file-size" value="100">
                            </div>
                            <div class="setting-item">
                                <label>Allowed File Types</label>
                                <input type="text" class="form-control" id="allowed-types" value="pdf,doc,docx,ppt,pptx,xls,xlsx,jpg,jpeg,png,mp4,mp3">
                            </div>
                        </div>
                        
                        <div class="setting-group">
                            <h4>Admin Account</h4>
                            <div class="setting-item">
                                <label>Admin Email</label>
                                <input type="email" class="form-control" id="admin-email" value="admin@steamlms.com">
                            </div>
                            <div class="setting-item">
                                <label>Change Password</label>
                                <input type="password" class="form-control" id="admin-password" placeholder="New password">
                            </div>
                        </div>
                        
                        <div class="setting-group">
                            <button class="btn btn-success" onclick="saveSettings()">
                                <i class="fas fa-save me-2"></i>Save Settings
                            </button>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <!-- Modals -->
    <!-- Content Modal -->
    <div class="modal fade" id="contentModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add/Edit Content</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="content-form">
                        <div class="mb-3">
                            <label class="form-label">Title</label>
                            <input type="text" class="form-control" id="content-title" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="content-description" rows="3"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Grade</label>
                                <select class="form-select" id="content-grade" required>
                                    <option value="">Select Grade</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Category</label>
                                <select class="form-select" id="content-category" required onchange="loadSubcategories()">
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Subcategories</label>
                            <div class="subcategory-selection" id="subcategory-selection">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="all-categories" value="all">
                                    <label class="form-check-label" for="all-categories">
                                        <strong>All Categories (Content applies to all subcategories)</strong>
                                    </label>
                                </div>
                                <p class="text-muted">Select category to see available subcategories</p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Content Type</label>
                            <select class="form-select" id="content-type" required>
                                <option value="">Select Type</option>
                                <option value="lesson">Lesson</option>
                                <option value="assignment">Assignment</option>
                                <option value="resource">Resource</option>
                                <option value="video">Video</option>
                                <option value="quiz">Quiz</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Upload New Files</label>
                            <div class="upload-zone" id="content-upload-zone">
                                <div class="upload-content">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <h5>Drag & Drop Files</h5>
                                    <p>or click to browse</p>
                                    <input type="file" id="content-file-input" multiple accept=".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.jpg,.jpeg,.png,.gif,.mp4,.mp3,.wav">
                                    <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('content-file-input').click()">
                                        <i class="fas fa-folder-open me-2"></i>Browse
                                    </button>
                                </div>
                            </div>
                            <div id="content-upload-preview" class="mt-3"></div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Associated Files</label>
                            <div class="file-association" id="file-association">
                                <p class="text-muted">No files associated. Upload files above or select from existing files.</p>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveContent()">Save Content</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Database Settings Modal -->
    <div class="modal fade" id="databaseModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Database Settings</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="database-form">
                        <div class="mb-3">
                            <label class="form-label">Database Type</label>
                            <select class="form-select" id="database-type" onchange="showDatabaseOptions()">
                                <option value="localStorage">Browser Storage (localStorage)</option>
                                <option value="indexedDB">Browser Database (IndexedDB)</option>
                                <option value="json">JSON File System</option>
                                <option value="firebase">Firebase Cloud Database</option>
                                <option value="mysql">MySQL Database</option>
                                <option value="mongodb">MongoDB Database</option>
                                <option value="sqlite">SQLite Database</option>
                            </select>
                        </div>
                        
                        <div id="database-options" class="mb-3">
                            <p class="text-muted">Select a database type to see configuration options.</p>
                        </div>
                        
                        <div class="alert alert-info">
                            <h6><i class="fas fa-info-circle me-2"></i>Current Database: <span id="current-db-type">localStorage</span></h6>
                            <p class="mb-0">Your current data will be migrated when you switch database types.</p>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveDatabaseSettings()">Save Database Settings</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Grade Modal -->
    <div class="modal fade" id="gradeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add/Edit Grade</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="grade-form">
                        <input type="hidden" id="grade-id" value="">
                        <div class="mb-3">
                            <label class="form-label">Grade Name</label>
                            <input type="text" class="form-control" id="grade-name" required placeholder="e.g., Grade 1">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="grade-description" rows="3" placeholder="Describe the grade level curriculum..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Age Range</label>
                            <input type="text" class="form-control" id="grade-age-range" placeholder="e.g., 6-7 years">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="delete-grade-btn" style="display: none;">
                        <i class="fas fa-trash me-2"></i>Delete
                    </button>
                    <button type="button" class="btn btn-primary" id="save-grade-btn">
                        <i class="fas fa-save me-2"></i><span id="grade-save-text">Add Grade</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Category Modal -->
    <div class="modal fade" id="categoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add/Edit Category</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="category-form">
                        <div class="mb-3">
                            <label class="form-label">Category Name</label>
                            <input type="text" class="form-control" id="category-name" required placeholder="e.g., Mathematics">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="category-description" rows="3" placeholder="Describe the category..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Subcategories (comma-separated)</label>
                            <input type="text" class="form-control" id="category-subcategories" placeholder="e.g., Algebra, Geometry, Statistics">
                            <small class="text-muted">Enter subcategories separated by commas</small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveCategory()">Save Category</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- File Viewer Modal -->
    <div class="modal fade" id="fileViewerModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">File Viewer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="file-viewer-content">
                        <!-- File content will be displayed here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="download-file-btn">Download</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Content Modal -->
    <div id="edit-modal-container"></div>
    
    <!-- Grade Management Modal -->
    <div id="grade-modal-container"></div>
    
    <!-- Category Management Modal -->
    <div id="category-modal-container"></div>
    
    <!-- Enhanced Content Modal with File Management -->
    <div class="modal fade" id="enhancedContentModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Content Management - Upload & Organize Files</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <!-- Content Details -->
                        <div class="col-md-6">
                            <h6>Content Details</h6>
                            <form id="enhanced-content-form">
                                <input type="hidden" id="enhanced-content-id" value="">
                                <div class="mb-3">
                                    <label class="form-label">Content Title</label>
                                    <input type="text" class="form-control" id="enhanced-content-title" required placeholder="e.g., Mathematics Lesson 1 - Introduction">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" id="enhanced-content-description" rows="3" placeholder="Describe this content..."></textarea>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Grade</label>
                                        <select class="form-select" id="enhanced-content-grade" required>
                                            <option value="">Select Grade</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Category</label>
                                        <select class="form-select" id="enhanced-content-category" required>
                                            <option value="">Select Category</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Content Type</label>
                                    <select class="form-select" id="enhanced-content-type">
                                        <option value="lesson">Lesson</option>
                                        <option value="assignment">Assignment</option>
                                        <option value="resource">Resource</option>
                                        <option value="video">Video</option>
                                        <option value="quiz">Quiz</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="make-files-public" checked>
                                        <label class="form-check-label" for="make-files-public">
                                            Make files available to public users
                                        </label>
                                    </div>
                                </div>
                            </form>
                        </div>
                        
                        <!-- File Upload Section -->
                        <div class="col-md-6">
                            <h6>File Upload</h6>
                            
                            <!-- File Categories -->
                            <div class="mb-3">
                                <label class="form-label">File Categories</label>
                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-check">
                                            <input class="form-check-input file-category-check" type="checkbox" value="video" id="cat-videos">
                                            <label class="form-check-label" for="cat-videos">
                                                <i class="fas fa-video text-danger"></i> Videos
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input file-category-check" type="checkbox" value="exercise" id="cat-exercises">
                                            <label class="form-check-label" for="cat-exercises">
                                                <i class="fas fa-pencil-alt text-primary"></i> Exercises
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input file-category-check" type="checkbox" value="memo" id="cat-memos">
                                            <label class="form-check-label" for="cat-memos">
                                                <i class="fas fa-key text-success"></i> Memos
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-check">
                                            <input class="form-check-input file-category-check" type="checkbox" value="document" id="cat-documents">
                                            <label class="form-check-label" for="cat-documents">
                                                <i class="fas fa-file-pdf text-purple"></i> Documents
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input file-category-check" type="checkbox" value="presentation" id="cat-presentations">
                                            <label class="form-check-label" for="cat-presentations">
                                                <i class="fas fa-presentation text-warning"></i> Presentations
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input file-category-check" type="checkbox" value="resource" id="cat-resources">
                                            <label class="form-check-label" for="cat-resources">
                                                <i class="fas fa-book text-info"></i> Resources
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- File Upload Area -->
                            <div class="mb-3">
                                <label class="form-label">Select Files</label>
                                <input type="file" class="form-control" id="enhanced-file-input" multiple accept="video/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,image/*,audio/*">
                                <small class="text-muted">You can select multiple files. Videos, PDFs, documents, presentations, images, and audio files are supported.</small>
                            </div>
                            
                            <!-- Selected Files Preview -->
                            <div id="selected-files-preview" class="mb-3">
                                <h6>Selected Files:</h6>
                                <div id="files-list" class="border rounded p-2" style="max-height: 200px; overflow-y: auto;">
                                    <p class="text-muted text-center">No files selected</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Existing Files Section -->
                    <div class="mt-4">
                        <h6>Existing Files (if editing)</h6>
                        <div id="existing-files-container">
                            <!-- Existing files will be loaded here -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="delete-enhanced-content-btn" style="display: none;">
                        <i class="fas fa-trash me-2"></i>Delete Content
                    </button>
                    <button type="button" class="btn btn-primary" id="save-enhanced-content-btn">
                        <i class="fas fa-save me-2"></i><span id="enhanced-save-text">Create Content</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/toast-manager.js"></script>
    <script src="assets/js/simple-admin.js"></script>
    <script>
        // Simple authentication check
        function isLoggedIn() {
            const session = localStorage.getItem('steam_lms_admin_session');
            if (session) {
                const data = JSON.parse(session);
                return data.isLoggedIn === true;
            }
            return false;
        }
        
        // Check authentication before initializing dashboard
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üîç Checking authentication...');
            
            if (!isLoggedIn()) {
                console.log('‚ùå Not logged in, redirecting to login...');
                window.location.href = 'simple-login.html';
                return;
            }
            
            console.log('‚úÖ Authentication confirmed, dashboard will auto-initialize...');
            
            // Add logout functionality
            const logoutLink = document.querySelector('.sidebar-footer a');
            if (logoutLink) {
                logoutLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (confirm('Are you sure you want to logout?')) {
                        localStorage.removeItem('steam_lms_admin_session');
                        localStorage.removeItem('steam_lms_admin_token');
                        window.location.href = 'simple-login.html';
                    }
                });
            }
            
            // Update admin name in header
            const session = localStorage.getItem('steam_lms_admin_session');
            if (session) {
                const data = JSON.parse(session);
                const adminNameElement = document.querySelector('.admin-name');
                if (adminNameElement) {
                    adminNameElement.textContent = data.name || 'Administrator';
                }
            }
        });
        
        // Debug functions
        function debugDataLoad() {
            console.log('üêõ Debug: Manual data load triggered');
            if (window.dashboard) {
                console.log('üêõ Dashboard instance found:', window.dashboard);
                window.dashboard.loadAllData();
            } else {
                console.error('‚ùå Dashboard instance not found');
            }
        }
        
        async function testAPI() {
            console.log('üß™ Testing API connections...');
            try {
                const [content, grades, categories, files] = await Promise.all([
                    fetch('http://localhost:3000/api/content'),
                    fetch('http://localhost:3000/api/grades'),
                    fetch('http://localhost:3000/api/categories'),
                    fetch('http://localhost:3000/api/files')
                ]);
                
                const data = {
                    content: await content.json(),
                    grades: await grades.json(),
                    categories: await categories.json(),
                    files: await files.json()
                };
                
                console.log('üß™ API Test Results:', data);
                alert(`‚úÖ API Working!\nContent: ${data.content.data?.length || 0} items\nGrades: ${data.grades.data?.length || 0} items\nCategories: ${data.categories.data?.length || 0} items\nFiles: ${data.files.data?.length || 0} items`);
            } catch (error) {
                console.error('‚ùå API Test Failed:', error);
                alert(`‚ùå API Error: ${error.message}`);
            }
        }
    </script>
</body>
</html>
